<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Category: istio/istio-traffic - Blog</title><link rel="manifest" href="/blog/manifest.json"><meta name="application-name" content="Blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Blog"><meta property="og:url" content="https://seongtaekkim.github.io/blog"><meta property="og:site_name" content="Blog"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://seongtaekkim.github.io/blog/img/og_image.png"><meta property="article:author" content="Seongtaek Kim"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://seongtaekkim.github.io/blog/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://seongtaekkim.github.io/blog"},"headline":"Blog","image":["https://seongtaekkim.github.io/blog/img/og_image.png"],"author":{"@type":"Person","name":"Seongtaek Kim"},"publisher":{"@type":"Organization","name":"Blog","logo":{"@type":"ImageObject"}},"description":""}</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/blog/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/blog/">Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/blog/">Home</a><a class="navbar-item" href="/blog/archives">Archives</a><a class="navbar-item" href="/blog/categories">Categories</a><a class="navbar-item" href="/blog/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/blog/categories">Categories</a></li><li class="is-active"><a href="#" aria-current="page">istio/istio-traffic</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-12-15T03:30:35.000Z" title="2024. 12. 15. 오후 12:30:35">2024-12-15</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-15T14:21:13.331Z" title="2024. 12. 15. 오후 11:21:13">2024-12-15</time></span><span class="level-item"><a class="link-muted" href="/blog/categories/istio-istio-traffic/">istio/istio-traffic</a></span><span class="level-item">13 minutes read (About 2015 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/2024/12/15/docs/istio/istio-traffic/">istio-traffic</a></h1><div class="content"><h3 id="클라이언트-요청-→-파드-인입"><a href="#클라이언트-요청-→-파드-인입" class="headerlink" title="클라이언트(요청) → 파드(인입)"></a>클라이언트(요청) → 파드(인입)</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 아래 처럼 정상적으로 웹 서버 접속 정보 출력 확인</span></span><br><span class="line">curl -s -v <span class="variable">$MYDOMAIN</span>:<span class="variable">$IGWHTTP</span></span><br><span class="line">curl -s <span class="variable">$MYDOMAIN</span>:<span class="variable">$IGWHTTP</span> | grep -o <span class="string">&quot;&lt;title&gt;.*&lt;/title&gt;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> curl -s <span class="variable">$MYDOMAIN</span>:<span class="variable">$IGWHTTP</span> | grep -o <span class="string">&quot;&lt;title&gt;.*&lt;/title&gt;&quot;</span> ; <span class="built_in">echo</span> <span class="string">&quot;--------------&quot;</span> ; <span class="built_in">sleep</span> 1; <span class="keyword">done</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> curl -s <span class="variable">$MYDOMAIN</span>:<span class="variable">$IGWHTTP</span> | grep -o <span class="string">&quot;&lt;title&gt;.*&lt;/title&gt;&quot;</span> ; <span class="built_in">echo</span> <span class="string">&quot;--------------&quot;</span> ; <span class="built_in">sleep</span> 0.1; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">curl -s --user-agent <span class="string">&quot;IPHONE&quot;</span> <span class="variable">$MYDOMAIN</span>:<span class="variable">$IGWHTTP</span> | grep -o <span class="string">&quot;&lt;title&gt;.*&lt;/title&gt;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> curl -s <span class="variable">$MYDOMAIN</span>:<span class="variable">$IGWHTTP</span> | grep -o <span class="string">&quot;&lt;title&gt;.*&lt;/title&gt;&quot;</span>; <span class="built_in">date</span> <span class="string">&quot;+%Y-%m-%d %H:%M:%S&quot;</span> ; <span class="built_in">echo</span> <span class="string">&quot;--------------&quot;</span> ; <span class="built_in">sleep</span> 1; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 로그 확인</span></span><br><span class="line">kubetail -l app=nginx-app -f</span><br></pre></td></tr></table></figure>

<p><img src="/blog/img/istio-24.png"></p>
<h3 id="Istio-IngressGateway-파드-→-노드-인입"><a href="#Istio-IngressGateway-파드-→-노드-인입" class="headerlink" title="Istio IngressGateway 파드 → 노드 인입"></a>Istio IngressGateway 파드 → 노드 인입</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@k8s-w2:~<span class="comment"># ip -c route | grep 172.16.46.11</span></span><br><span class="line">172.16.46.11 dev cali8b56182ddcf scope <span class="built_in">link</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 노드의 NIC에서 패킷 덤프 시 파드의 목적지 IP로 바로 인입되는 것을 알 수 있다</span></span><br><span class="line">root@k8s-w2:~<span class="comment"># tcpdump -i enp0s8 -nn tcp port 80 -q</span></span><br><span class="line">17:31:16.074031 IP 172.16.228.76.54522 &gt; 172.16.46.11.80: tcp 1626</span><br><span class="line">17:31:16.074096 IP 172.16.46.11.80 &gt; 172.16.228.76.54522: tcp 0</span><br><span class="line">17:31:16.075258 IP 172.16.46.11.80 &gt; 172.16.228.76.54522: tcp 1591</span><br><span class="line">17:31:16.075598 IP 172.16.228.76.54522 &gt; 172.16.46.11.80: tcp 0</span><br><span class="line"></span><br><span class="line">root@k8s-w2:~<span class="comment"># ngrep -d enp0s8 -tW byline port 80</span></span><br><span class="line">T 2022/02/11 20:08:17.034879 172.16.158.5:43372 -&gt; 172.16.184.1:80 [AP] <span class="comment">#153</span></span><br><span class="line">GET / HTTP/1.1.</span><br><span class="line">host: www.gasida.dev:31526.</span><br><span class="line">user-agent: curl/7.68.0.</span><br><span class="line">accept: */*.</span><br><span class="line">x-forwarded-for: 192.168.10.254.</span><br><span class="line">x-forwarded-proto: http.</span><br><span class="line">x-envoy-internal: <span class="literal">true</span>.</span><br></pre></td></tr></table></figure>





<h3 id="파드-내부-IPTables-적용-→-Istio-proxy-컨테이너-인입"><a href="#파드-내부-IPTables-적용-→-Istio-proxy-컨테이너-인입" class="headerlink" title="[파드 내부] IPTables 적용 → Istio-proxy 컨테이너 인입*"></a>[파드 내부] IPTables 적용 → Istio-proxy 컨테이너 인입*</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 아래 처럼 &#x27;istio-init 컨테이너&#x27; 의 로그에 iptables rules 설정을 확인할 수 있습니다.</span></span><br><span class="line"><span class="comment"># 참고로, NAT Tables 만 설정되고, 그외(filter, mangle, raw 등)은 설정하지 않습니다.</span></span><br><span class="line">(istio-k8s:default) root@k8s-m:~<span class="comment"># kubectl logs nginx-pod -c istio-init</span></span><br><span class="line">* nat</span><br><span class="line">-N ISTIO_INBOUND</span><br><span class="line">-N ISTIO_REDIRECT</span><br><span class="line">-N ISTIO_IN_REDIRECT</span><br><span class="line">-N ISTIO_OUTPUT</span><br><span class="line">-A ISTIO_INBOUND -p tcp --dport 15008 -j RETURN</span><br><span class="line">-A ISTIO_REDIRECT -p tcp -j REDIRECT --to-ports 15001</span><br><span class="line">-A ISTIO_IN_REDIRECT -p tcp -j REDIRECT --to-ports 15006</span><br><span class="line">-A PREROUTING -p tcp -j ISTIO_INBOUND</span><br><span class="line">-A ISTIO_INBOUND -p tcp --dport 22 -j RETURN</span><br><span class="line">-A ISTIO_INBOUND -p tcp --dport 15090 -j RETURN</span><br><span class="line">-A ISTIO_INBOUND -p tcp --dport 15021 -j RETURN</span><br><span class="line">-A ISTIO_INBOUND -p tcp --dport 15020 -j RETURN</span><br><span class="line">-A ISTIO_INBOUND -p tcp -j ISTIO_IN_REDIRECT</span><br><span class="line">-A OUTPUT -p tcp -j ISTIO_OUTPUT</span><br><span class="line">-A ISTIO_OUTPUT -o lo -s 127.0.0.6/32 -j RETURN</span><br><span class="line">-A ISTIO_OUTPUT -o lo ! -d 127.0.0.1/32 -m owner --uid-owner 1337 -j ISTIO_IN_REDIRECT</span><br><span class="line">-A ISTIO_OUTPUT -o lo -m owner ! --uid-owner 1337 -j RETURN</span><br><span class="line">-A ISTIO_OUTPUT -m owner --uid-owner 1337 -j RETURN</span><br><span class="line">-A ISTIO_OUTPUT -o lo ! -d 127.0.0.1/32 -m owner --gid-owner 1337 -j ISTIO_IN_REDIRECT</span><br><span class="line">-A ISTIO_OUTPUT -o lo -m owner ! --gid-owner 1337 -j RETURN</span><br><span class="line">-A ISTIO_OUTPUT -m owner --gid-owner 1337 -j RETURN</span><br><span class="line">-A ISTIO_OUTPUT -d 127.0.0.1/32 -j RETURN</span><br><span class="line">-A ISTIO_OUTPUT -j ISTIO_REDIRECT</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure>

<p><img src="/blog/img/istio-25.png"></p>
<h4 id="‘Istio-proxy-컨테이너’의-15006-Listener-확인"><a href="#‘Istio-proxy-컨테이너’의-15006-Listener-확인" class="headerlink" title="‘Istio-proxy 컨테이너’의 15006 Listener 확인"></a>‘Istio-proxy 컨테이너’의 15006 Listener 확인</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 변수 지정 : C1(Istio-proxy, Envoy , 단축키 지정</span></span><br><span class="line">lsns -t net</span><br><span class="line">ps -ef |grep istio</span><br><span class="line">1337      347173  347155  0 18:52 ?        00:00:01 /usr/local/bin/envoy -c etc/istio/proxy/envoy-rev.json --drain-time-s 45 --drain-strategy immediate --local-address-ip-version v4 --file-flush-interval-msec 1000 --disable-hot-restart --allow-unknown-static-fields -l warning --component-log-level misc:error --concurrency 2</span><br><span class="line">C1PID=347173</span><br><span class="line"><span class="built_in">alias</span> c1=<span class="string">&quot;nsenter -t <span class="variable">$C1PID</span> -n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ss (socket statistics)로 시스템 소켓 상태 확인 : 15006 은 envoy 프로세스가 Listen 하고 있다</span></span><br><span class="line">root@k8s-w2:~<span class="comment"># c1 ss -tpnl &#x27;( dport = :15006 or sport = :15006 )&#x27;</span></span><br><span class="line">State      Recv-Q      Send-Q           Local Address:Port            Peer Address:Port     Process</span><br><span class="line">LISTEN     0           4096                   0.0.0.0:15006                0.0.0.0:*         <span class="built_in">users</span>:((&quot;envoy&quot;,pid=<span class="number">3928</span>,fd=<span class="number">37</span>))</span><br><span class="line">LISTEN     0           4096                   0.0.0.0:15006                0.0.0.0:*         <span class="built_in">users</span>:((&quot;envoy&quot;,pid=<span class="number">3928</span>,fd=<span class="number">36</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 확인 예시</span></span><br><span class="line">c1 ss -tpnt <span class="string">&#x27;( dport = :15006 or sport = :15006 or sport = :80 or dport = :80 )&#x27;</span></span><br><span class="line">watch -d <span class="string">&quot;nsenter -t <span class="variable">$C1PID</span> -n  ss -tpnt &#x27;( dport = :15006 or sport = :15006 or sport = :80 or dport = :80 )&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 연결된 소켓 강제 Reset</span></span><br><span class="line"><span class="comment"># c0 ss -K dst 172.16.228.66 dport = 44526</span></span><br><span class="line">c1 ss -K dst 172.16.228.66</span><br><span class="line">c1 ss -K dst 172.16.46.13</span><br></pre></td></tr></table></figure>





<h3 id="파드-내부-Istio-proxy-컨테이너-→-IPTables-적용"><a href="#파드-내부-Istio-proxy-컨테이너-→-IPTables-적용" class="headerlink" title="[파드 내부] Istio-proxy 컨테이너 → IPTables 적용"></a>[파드 내부] Istio-proxy 컨테이너 → IPTables 적용</h3><h4 id="‘Istio-proxy-컨테이너’-는-대리인-Proxy-역할로-출발지-IP를-127-0-0-6-으로-변경하여-‘Nginx-컨테이너’와-연결을-한다"><a href="#‘Istio-proxy-컨테이너’-는-대리인-Proxy-역할로-출발지-IP를-127-0-0-6-으로-변경하여-‘Nginx-컨테이너’와-연결을-한다" class="headerlink" title="‘Istio-proxy 컨테이너’ 는 대리인(Proxy) 역할로, 출발지 IP를 127.0.0.6 으로 변경하여 ‘Nginx 컨테이너’와 연결을 한다"></a>‘Istio-proxy 컨테이너’ 는 대리인(Proxy) 역할로, 출발지 IP를 127.0.0.6 으로 변경하여 ‘Nginx 컨테이너’와 연결을 한다</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 로그 내용 중 출발지 정보(127.0.0.6:50763)를 변경하고 전달하는 것을 알 수 있다</span></span><br><span class="line">(istio-k8s:default) root@k8s-m:~<span class="comment"># kubectl logs nginx-pod -c istio-proxy -f</span></span><br><span class="line">[2021-12-15T18:05:56.334Z] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 - via_upstream - <span class="string">&quot;-&quot;</span> 0 615 0 0 <span class="string">&quot;192.168.10.254&quot;</span> <span class="string">&quot;curl/7.68.0&quot;</span> <span class="string">&quot;0844349b-d290-994b-93b2-da36bf929c62&quot;</span> <span class="string">&quot;www.gasida.dev:30384&quot;</span> <span class="string">&quot;172.16.46.11:80&quot;</span> inbound|80|| 127.0.0.6:50763 172.16.46.11:80 192.168.10.254:0 - default</span><br></pre></td></tr></table></figure>





<h3 id="파드-내부-IPTables-적용-→-Nginx-컨테이너-인입"><a href="#파드-내부-IPTables-적용-→-Nginx-컨테이너-인입" class="headerlink" title="[파드 내부] IPTables 적용 → Nginx 컨테이너 인입"></a>[파드 내부] IPTables 적용 → Nginx 컨테이너 인입</h3><p>파드 내에 IPTables 는 전역(?)으로 적용되므로, ‘Istio-proxy’ 의 인&#x2F;아웃 시 트래픽 구별이 중요하다.</p>
<ul>
<li>‘Istio-proxy’ 를 빠져나올때는 출발지 IP가 127.0.0.6 이므로 ISTIO_OUTPUT 에 적용되어 리턴되어 POSTROUTING 를 통해 nginx 로 도착한다</li>
<li>IPTables 확인 : istio-proxy → OUTPUT → <strong>ISTIO_OUTOUT</strong>(맨 상단 Rule 매칭으로 RETURN) -&gt; POSTROUTING -&gt; NGINX 컨테이너</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 출발IP가 127.0.0.6 이고, 빠져나오는 인터페이스가(-o lo)에 매칭되어 리턴됨</span></span><br><span class="line">c1 iptables -v --numeric --table nat --list ISTIO_OUTPUT</span><br><span class="line">Chain ISTIO_OUTPUT (1 references)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line">    2   120 RETURN     all  --  *      lo      127.0.0.6            0.0.0.0/0</span><br><span class="line"></span><br><span class="line"><span class="comment"># POSTROUTING 은 특별한 rule 이 없으니 통과!</span></span><br><span class="line">Chain POSTROUTING (policy ACCEPT 144 packets, 12545 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모니터링 예시</span></span><br><span class="line">c1 iptables -t nat --zero</span><br><span class="line">c1 iptables -v --numeric --table nat --list ISTIO_OUTPUT</span><br><span class="line">watch -d <span class="string">&quot;nsenter -t <span class="variable">$C1PID</span> -n iptables -v --numeric --table nat --list OUTPUT; echo ; nsenter -t <span class="variable">$C1PID</span> -n iptables -v --numeric --table nat --list ISTIO_OUTPUT; echo ; nsenter -t <span class="variable">$C1PID</span> -n iptables -v --numeric --table nat --list POSTROUTING&quot;</span></span><br><span class="line">watch -d <span class="string">&quot;nsenter -t <span class="variable">$C1PID</span> -n iptables -t nat -L -n -v&quot;</span></span><br></pre></td></tr></table></figure>



<p>최종적으로 nginx 컨테이너에 클라이언트의 요청 트래픽이 도착한다.</p>
<ul>
<li>nginx 컨테이너의 웹 액세스 로그에서 확인 : XFF 헤더에서 클라이언트의 출발지 IP를 확인</li>
</ul>
<h3 id="파드-리턴-트래픽-→-클라이언트"><a href="#파드-리턴-트래픽-→-클라이언트" class="headerlink" title="파드(리턴 트래픽) → 클라이언트"></a>파드(리턴 트래픽) → 클라이언트</h3><ul>
<li>nginx (웹 서버)컨테이너에서 리턴 트래픽(응답, 200 OK)를 클라이언트에 전달합니다.</li>
<li>IPTables CT(Connection Table)에 정보를 참고해서 역변환 등이 적용되어 전달됩니다.</li>
</ul>
<p><img src="/blog/img/istio-26.png"></p>
<h3 id="파드-요청-→-외부-웹서버"><a href="#파드-요청-→-외부-웹서버" class="headerlink" title="파드(요청) → 외부 웹서버"></a>파드(요청) → 외부 웹서버</h3><p>파드에서 업데이트 나 패치 다운로드 처럼 외부 웹서버 나 인터넷 연결 과정에서의 트래픽의 흐름입니다.</p>
<p><img src="/blog/img/istio-27.png"></p>
<p>파드 내 IPTables 적용 흐름 : 아래 (9) ~ (15) 까지의 과정을 먼저 설명합니다.</p>
<p><img src="/blog/img/istio-28.png"></p>
<h3 id="파드-내부-Client-PC-→-Istio-IngressGateway-파드-구간"><a href="#파드-내부-Client-PC-→-Istio-IngressGateway-파드-구간" class="headerlink" title="[파드 내부] Client PC → Istio IngressGateway 파드 구간"></a>[파드 내부] Client PC → Istio IngressGateway 파드 구간</h3><p>‘nginx 컨테이너’ 에서 외부 웹서버 요청</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 아래 처럼 &#x27;nginx 컨테이너&#x27; 에서 외부 웹서버 요청</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -s 192.168.10.254</span><br><span class="line">kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -s http://wttr.in/seoul</span><br><span class="line">kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -s wttr.in/seoul?format=3</span><br><span class="line">kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -s <span class="string">&#x27;wttr.in/&#123;London,Busan&#125;&#x27;</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -s http://ipinfo.io/city</span><br><span class="line">kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -k https://www.google.com | grep -o <span class="string">&quot;&lt;title&gt;.*&lt;/title&gt;&quot;</span>;<span class="built_in">echo</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> kubectl <span class="built_in">exec</span> -it nginx-pod -c nginx-container -- curl -s http://ipinfo.io/city; <span class="built_in">date</span> <span class="string">&quot;+%Y-%m-%d %H:%M:%S&quot;</span> ; <span class="built_in">echo</span> <span class="string">&quot;--------------&quot;</span> ; <span class="built_in">sleep</span> 3; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(⎈|default:N/A) root@k3s-s:~<span class="comment"># c1 conntrack -L --dst-nat</span></span><br><span class="line">tcp      6 431348 ESTABLISHED src=172.16.1.4 dst=172.16.0.10 sport=36300 dport=80 src=172.16.0.10 dst=172.16.1.4 sport=15006 dport=36300 [ASSURED] mark=0 use=1</span><br><span class="line">conntrack v1.4.6 (conntrack-tools): 1 flow entries have been shown.</span><br></pre></td></tr></table></figure>





<h3 id="파드-내부-IPTables-→-Istio-proxy-컨테이너-인입"><a href="#파드-내부-IPTables-→-Istio-proxy-컨테이너-인입" class="headerlink" title="[파드 내부] IPTables → Istio-proxy 컨테이너 인입"></a>[파드 내부] IPTables → Istio-proxy 컨테이너 인입</h3><p>파드 내 IPTables Chains&#x2F;Rules 적용 (NAT 테이블) → ‘Istio-proxy 컨테이너’로 인입됩니다.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># iptables 확인</span></span><br><span class="line">c1 iptables -t nat --zero</span><br><span class="line">c1 iptables -v --numeric --table nat --list ISTIO_REDIRECT</span><br><span class="line">watch -d <span class="string">&quot;nsenter -t <span class="variable">$C1PID</span> -n iptables -v --numeric --table nat --list OUTPUT; echo ; nsenter -t <span class="variable">$C1PID</span> -n iptables -v --numeric --table nat --list ISTIO_OUTPUT; echo ; nsenter -t <span class="variable">$C1PID</span> -n iptables -v --numeric --table nat --list ISTIO_REDIRECT&quot;</span></span><br><span class="line">watch -d <span class="string">&quot;nsenter -t <span class="variable">$C1PID</span> -n iptables -t nat -L -n -v&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nginx 파드에서 TCP 트래픽 요청으로 인입 시, ISTIO_REDIRECT 에서 redir ports 15001 되어 &#x27;Istio-proxy 컨테이너&#x27;로 인입됩니다.</span></span><br><span class="line">c1 iptables -t nat -L -n -v</span><br><span class="line">Chain OUTPUT (policy ACCEPT 5 packets, 455 bytes)</span><br><span class="line"> pkts bytes target        prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line">    0     0 ISTIO_OUTPUT  tcp  --  *      *       0.0.0.0/0            0.0.0.0/0</span><br><span class="line"></span><br><span class="line">Chain ISTIO_OUTPUT (1 references)</span><br><span class="line"> pkts bytes target          prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line"> ...</span><br><span class="line">    0     0 ISTIO_REDIRECT  all  --  *      *       0.0.0.0/0            0.0.0.0/0</span><br><span class="line"></span><br><span class="line">Chain ISTIO_REDIRECT (1 references)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line">    0     0 REDIRECT   tcp  --  *      *       0.0.0.0/0            0.0.0.0/0            redir ports 15001</span><br></pre></td></tr></table></figure>







<h3 id="파드-내부-Istio-proxy-컨테이너-→-노드의-호스트-네임스페이스"><a href="#파드-내부-Istio-proxy-컨테이너-→-노드의-호스트-네임스페이스" class="headerlink" title="[파드 내부] Istio-proxy 컨테이너 → 노드의 호스트 네임스페이스"></a>[파드 내부] Istio-proxy 컨테이너 → 노드의 호스트 네임스페이스</h3><p>‘Istio-proxy 컨테이너’ 는 대리인(Proxy) 역할로, 출발지 포트를 변경(+2) 후 외부 웹서버에 연결을 한다</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(⎈|default:N/A) root@k3s-s:~<span class="comment"># kubectl logs nginx-pod -c istio-proxy -f</span></span><br><span class="line">2024-10-19T19:56:27.631973Z	info	FLAG: --concurrency=<span class="string">&quot;0&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632053Z	info	FLAG: --domain=<span class="string">&quot;default.svc.cluster.local&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632062Z	info	FLAG: --<span class="built_in">help</span>=<span class="string">&quot;false&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632067Z	info	FLAG: --log_as_json=<span class="string">&quot;false&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632070Z	info	FLAG: --log_caller=<span class="string">&quot;&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632073Z	info	FLAG: --log_output_level=<span class="string">&quot;default:info&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632076Z	info	FLAG: --log_rotate=<span class="string">&quot;&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632079Z	info	FLAG: --log_rotate_max_age=<span class="string">&quot;30&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632082Z	info	FLAG: --log_rotate_max_backups=<span class="string">&quot;1000&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632085Z	info	FLAG: --log_rotate_max_size=<span class="string">&quot;104857600&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632088Z	info	FLAG: --log_stacktrace_level=<span class="string">&quot;default:none&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632108Z	info	FLAG: --log_target=<span class="string">&quot;[stdout]&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632112Z	info	FLAG: --meshConfig=<span class="string">&quot;./etc/istio/config/mesh&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632115Z	info	FLAG: --outlierLogPath=<span class="string">&quot;&quot;</span></span><br><span class="line">2024-10-19T19:56:27.632118Z	info	FLAG: --profiling=<span class="string">&quot;true&quot;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(⎈|default:N/A) root@k3s-s:~<span class="comment"># c1 lsof -i TCP:80,15006 -n</span></span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br><span class="line">COMMAND   PID            USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">nginx   31348            root    6u  IPv4 316778      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31348            root    7u  IPv6 316779      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31386 systemd-resolve    6u  IPv4 316778      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31386 systemd-resolve    7u  IPv6 316779      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31387 systemd-resolve    6u  IPv4 316778      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31387 systemd-resolve    7u  IPv6 316779      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31388 systemd-resolve    6u  IPv4 316778      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31388 systemd-resolve    7u  IPv6 316779      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31389 systemd-resolve    6u  IPv4 316778      0t0  TCP *:http (LISTEN)</span><br><span class="line">nginx   31389 systemd-resolve    7u  IPv6 316779      0t0  TCP *:http (LISTEN)</span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br><span class="line">envoy   31423            1337   38u  IPv4 317525      0t0  TCP *:15006 (LISTEN)</span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br><span class="line">envoy   31423            1337   42u  IPv4 317526      0t0  TCP *:15006 (LISTEN)</span><br><span class="line">lsof: no <span class="built_in">pwd</span> entry <span class="keyword">for</span> UID 1337</span><br></pre></td></tr></table></figure>































</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/blog/img/avatar.png" alt="Seongtaek Kim"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Seongtaek Kim</p><p class="is-size-6 is-block">Blog</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/blog/archives"><p class="title">45</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/blog/categories"><p class="title">34</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/blog/tags"><p class="title">0</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/seongtaekkim"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://linkedin.com/in/staek"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/categories/calico-communication/"><span class="level-start"><span class="level-item">calico/communication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/calico-concept/"><span class="level-start"><span class="level-item">calico/concept</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/calico-networkmode/"><span class="level-start"><span class="level-item">calico/networkmode</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/cilium-cilium/"><span class="level-start"><span class="level-item">cilium/cilium</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/cilium-communication/"><span class="level-start"><span class="level-item">cilium/communication</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/cilium-install/"><span class="level-start"><span class="level-item">cilium/install</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/container-cgroup/"><span class="level-start"><span class="level-item">container/cgroup</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/container-namespace/"><span class="level-start"><span class="level-item">container/namespace</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/container-overlayFS/"><span class="level-start"><span class="level-item">container/overlayFS</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/container-overlaynetwork/"><span class="level-start"><span class="level-item">container/overlaynetwork</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/gateway-gatewayapi/"><span class="level-start"><span class="level-item">gateway/gatewayapi</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/gateway-gloo/"><span class="level-start"><span class="level-item">gateway/gloo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/ingress-ingress/"><span class="level-start"><span class="level-item">ingress/ingress</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/istio-bookinfo/"><span class="level-start"><span class="level-item">istio/bookinfo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/istio-envoy/"><span class="level-start"><span class="level-item">istio/envoy</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/istio-istio-outline/"><span class="level-start"><span class="level-item">istio/istio-outline</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/istio-istio-test/"><span class="level-start"><span class="level-item">istio/istio-test</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/istio-istio-traffic/"><span class="level-start"><span class="level-item">istio/istio-traffic</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/java-Enumeration/"><span class="level-start"><span class="level-item">java/Enumeration</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/java-flyweight/"><span class="level-start"><span class="level-item">java/flyweight</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/java-interface/"><span class="level-start"><span class="level-item">java/interface</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/k8s-PAUSE-Container/"><span class="level-start"><span class="level-item">k8s/PAUSE-Container</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/k8s-flannel/"><span class="level-start"><span class="level-item">k8s/flannel</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/k8s-kind/"><span class="level-start"><span class="level-item">k8s/kind</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/loadbaleancer-ipvs/"><span class="level-start"><span class="level-item">loadbaleancer/ipvs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/loadbaleancer-ipvs-install/"><span class="level-start"><span class="level-item">loadbaleancer/ipvs-install</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/loadbaleancer-metalLB/"><span class="level-start"><span class="level-item">loadbaleancer/metalLB</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/loadbaleancer-metalLB-install/"><span class="level-start"><span class="level-item">loadbaleancer/metalLB-install</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/serivce-clusterip/"><span class="level-start"><span class="level-item">serivce/clusterip</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/serivce-install/"><span class="level-start"><span class="level-item">serivce/install</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/serivce-nodeport/"><span class="level-start"><span class="level-item">serivce/nodeport</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/vpccni-vpccni/"><span class="level-start"><span class="level-item">vpccni/vpccni</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/vpccni-vpccni-install/"><span class="level-start"><span class="level-item">vpccni/vpccni-install</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/vpccni-vpccni2/"><span class="level-start"><span class="level-item">vpccni/vpccni2</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-22T08:30:35.000Z">2024-12-22</time></p><p class="title"><a href="/blog/2024/12/22/docs/loadbalancer/metallb/">MetalLB</a></p><p class="categories"><a href="/blog/categories/loadbaleancer-metalLB/">loadbaleancer/metalLB</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-22T07:30:35.000Z">2024-12-22</time></p><p class="title"><a href="/blog/2024/12/22/docs/loadbalancer/ipvs-proxy/">ipvs-proxy</a></p><p class="categories"><a href="/blog/categories/loadbaleancer-ipvs/">loadbaleancer/ipvs</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-22T01:30:35.000Z">2024-12-22</time></p><p class="title"><a href="/blog/2024/12/22/docs/loadbalancer/ipvs-install/">ipvs-install</a></p><p class="categories"><a href="/blog/categories/loadbaleancer-ipvs-install/">loadbaleancer/ipvs-install</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-15T09:30:35.000Z">2024-12-15</time></p><p class="title"><a href="/blog/2024/12/15/docs/istio/bookinfo/">bookinfo</a></p><p class="categories"><a href="/blog/categories/istio-bookinfo/">istio/bookinfo</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-15T06:30:35.000Z">2024-12-15</time></p><p class="title"><a href="/blog/2024/12/15/docs/istio/envoy/">envoy</a></p><p class="categories"><a href="/blog/categories/istio-envoy/">istio/envoy</a></p></div></article></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/blog/">Blog</a><p class="is-size-7"><span>&copy; 2024 Seongtaek Kim</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/blog/js/column.js"></script><script src="/blog/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/blog/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/blog/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/blog/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>